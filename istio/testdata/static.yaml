schemaVersion: "1.0.0"
fileExistenceTests:
# Basic FS sanity checks.
- name: root
  path: '/'
  shouldExist: true
- name: tmp
  path: '/tmp'
  shouldExist: true
- name: passwd
  path: '/etc/passwd'
  shouldExist: true
- name: group
  path: '/etc/group'
  shouldExist: true
- name: etc-os-release
  path: '/etc/os-release'
  shouldExist: true
- name: certs
  path: '/etc/ssl/certs/ca-certificates.crt'
  shouldExist: true
- name: services
  path: '/etc/services'
  shouldExist: true
- name: tzdata
  path: '/usr/sbin/tzconfig'
  shouldExist: true
- name: homedir
  path: '/root'
  shouldExist: true
- name: nonroot-homedir
  path: '/home/nonroot'
  shouldExist: true
- name: istio-proxy-homedir
  path: '/home/istio-proxy'
  shouldExist: true
- name: dpkg-status.d
  path: '/var/lib/dpkg/status.d/libc6'
  shouldExist: false
- name: no-openssl
  path: '/usr/bin/openssl'
  shouldExist: false
fileContentTests:
- name: 'known users'
  path: '/etc/passwd'
  expectedContents:
  - "root:x:0:0:root:/root:/sbin/nologin"
  - "nonroot:x:65532:65532:nonroot:/home/nonroot:/sbin/nologin"
  - "istio-proxy:x:1337:1337:istio-proxy:/home/istio-proxy:/sbin/nologin"
- name: 'known groups'
  path: '/etc/group'
  expectedContents:
  - "root:x:0:"
  - "nobody:x:65534:"
  - "tty:x:5:"
  - "staff:x:50:"
  - "nonroot:x:65532:"
  - "istio-proxy:x:1337:"
